# Logrotate configuration for syslog-ng JSON logs
/app/logs/syslog.jsonl {
    # Rotate daily or when size reaches 100M
    size 100M
    daily

    # Keep 10 rotated files
    rotate 10

    # Don't error if log file is missing
    missingok

    # Don't rotate if file is empty
    notifempty

    # Compress rotated files
    compress
    delaycompress

    # Create new log file with specific permissions
    create 0644 syslog syslog

    # Append .gz extension after rotation number
    extension .jsonl

    # Post-rotation script to signal syslog-ng
    postrotate
        # Send HUP signal to syslog-ng to reopen log files
        /usr/bin/pkill -HUP syslog-ng || true
    endscript

    # Use date extension instead of numbers
    # dateext
    # dateformat -%Y%m%d-%s
}
